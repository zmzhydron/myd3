<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		#testspan{
			color: lime;
		}
		.hehe{
			width: 500px;
			height: 200px;
			border: solid 1px red;
			padding: 10px;
		}
		.green{
			fill: green;
		}
		.red{
			fill: red;
		}
	</style>
	<script src="d3main.js"></script>
</head>
<body>
	<div class="a" id='a'>aaa</div>
	<div class="a">aaa</div>
	<div class="a">aaa</div>
	<div class="a">aaa</div>
	<div class="a">aaa</div>
</body>
<script type="text/javascript">
	let data1 = ['my','name','is','zhangmingzhi'];
	let data2 = ['zmz'];

	document.addEventListener('DOMContentLoaded', event => {
		console.log(d3);
		let a = d3.selectAll(".a");
		let alist = Array.from(a._groups[0]);
		// a.datum(data1).text( (text,index) =>{
		// 	return `my name is ${text} current @ ${index}`;
		// })
		a.data(data1).text((text, index,a) =>{
			a[index].addEventListener("click", event =>{
				console.log(event.target);
			},false);
			return `i say: ${text}!!! to you`;
		})
		.style("color","red")
		.style("font-size","16px");
		//inser element
		// a.insert("p").text("this is inserted text!!")
		//set innerhtml;
		d3.select("#a").html("<span id='testspan'>11111</span>");
		console.log(a);
		//add svg
		let rectHeight = 50;
    function makebar(){
      let data3 = Array.from({length: 10}).map( item => ~~(Math.random() * 1000));
      d3.selectAll("svg").remove();
      let Yscale = d3.scaleLinear().domain([d3.min(data3),d3.max(data3)]).range([2,180]);
			let Xscale = d3.scaleLinear().domain([0,d3.max(data3)]).range([0,500]);
      let scaleforAxis = d3.scaleLinear().domain([1,10]).range([0,500]);
      let axis = d3.axisBottom(scaleforAxis);
      let svg = d3.select("body")
      .append("svg")
      .attr("id","fuck-you")
      .attr("class","hehe")
      .selectAll("rect")
      .data(data3)
      .enter()
      .append("rect")
      .on("click", (text, index,a,b,c) => {
          console.log(text,index,a,b,c);
      })
      .attr("x", (text, index) => {
				return 50*index
			})
      .attr("y", 0)
      .attr("height", text => Yscale(text))
      .transition()
      .duration(1000)
      .attr("width", 25)
      .attr("fill", (text ,index) => {
          return Math.random() > 0.5 ? "green" : 'red'
      })
      .attr("data-value", (text, i) => {
          return `current data is ${text}`
      })
      //make aixes
      d3.select("#fuck-you")
      .append("g")
      .attr("transform","translate(0,180)")
      .call(axis);
			//add top text
			let texts = d3.select("#fuck-you").selectAll(".textBox")
									.data(data3).enter().append("text")
									.attr("class","textBox")
									.attr("transform","translate(10,10)")
									.attr("x", (text, index) =>{
										return 50 * index
									})
									.attr("y", 0)
									.attr("dx", -10)
									.attr("dy", 0)
									.text(text => text)
    }
    makebar();
	},false)
</script>
</html>
